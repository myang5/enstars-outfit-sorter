(this["webpackJsonpenstars-outfit-sorter"]=this["webpackJsonpenstars-outfit-sorter"]||[]).push([[0],[,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/arrow_down_darkblue.87e78f37.svg"},,,,function(e,t,a){e.exports=a.p+"static/media/instructions0.d5dad995.png"},function(e,t,a){e.exports=a.p+"static/media/instructions1.e918fb19.png"},function(e,t,a){e.exports=a.p+"static/media/platform.deae2014.svg"},function(e,t,a){e.exports=a.p+"static/media/arrow_left_darkblue.76314777.svg"},function(e,t,a){e.exports=a.p+"static/media/arrow_up_darkblue.727d3630.svg"},function(e,t,a){e.exports=a.p+"static/media/filter_darkblue.224365ea.svg"},,function(e,t,a){e.exports=a(26)},,,,,function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(11),i=a.n(r),o=(a(24),a(7)),l=a(9),c=a(2),u=a(3),m=a(1),h=a(5),d=a(4),p=a(6),f=a(12),g=a.n(f),b=a(13),v=a.n(b);function E(e){return s.a.createElement("div",{className:"overlay"},s.a.createElement("div",{className:"overlayContent",id:"instructions"},s.a.createElement("div",{className:"topContainer"},s.a.createElement("div",{className:"top"},s.a.createElement("h3",null,"How to Import User Data"),s.a.createElement("p",null,"Make a copy of this ",s.a.createElement("a",{target:"_blank",href:"https://docs.google.com/spreadsheets/d/1asGXfBIw2qe3xYX_mawgbjO34gYqsj6IBNRbzqtqNAQ/edit?usp=sharing"},"Google spreadsheet template")," and fill it with your outfits."),s.a.createElement("ul",null,s.a.createElement("p",null,s.a.createElement("strong",null,"Notes on the spreadsheet format")),s.a.createElement("li",null,s.a.createElement("strong",null,"Must have:")," a sheet named Outfits with columns labeled Character, Outfit, and Made."),s.a.createElement("li",null,s.a.createElement("strong",null,"Optional: ")," the Idol Status sheet and Validation Lists sheet"),s.a.createElement("li",null,"The character and outfit names should match the spelling and translations in the database's ",s.a.createElement("a",{target:"_blank",href:"https://docs.google.com/spreadsheets/d/1JeHlN1zcBwyBbBkyfsDiiqDZpLotkn770ewa1JCsekU/edit#gid=350164119"},"Validation Lists"),".")),s.a.createElement("p",null,s.a.createElement("strong",null,"Turn link sharing on for the spreadsheet.")," Otherwise the sorter will not be able to access the contents."),s.a.createElement("ul",null,s.a.createElement("p",null,s.a.createElement("strong",null,"On desktop:")),s.a.createElement("li",null,s.a.createElement("p",null,"Click the 'Share' button in the top right corner and click 'Get shareable link'."),s.a.createElement("img",{src:g.a,alt:"Turn on link sharing"})),s.a.createElement("li",null,s.a.createElement("p",null,"Copy the provided link."),s.a.createElement("img",{src:v.a,alt:"Copy link"}))),s.a.createElement("p",null,"Copy the spreadsheet link into the sorter and click 'Add user data'."))),s.a.createElement("div",{className:"bottomContainer"},s.a.createElement("div",{className:"btn",onClick:e.toggleInstructions},"Close"))))}var O=a(14),y=a.n(O),M=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={isInstructions:!1},n.toggleInstructions=n.toggleInstructions.bind(Object(m.a)(n)),n}return Object(u.a)(a,[{key:"toggleInstructions",value:function(){this.setState((function(e){return{isInstructions:!e.isInstructions}}))}},{key:"render",value:function(){var e=this;if(this.props.activeJob&&this.props.teamMembers.length>0){var t=this.props.teamMembers.map((function(t,a){return s.a.createElement(k,{key:a,index:a,member:t,selAttr:e.props.selAttr,toggleOutfitList:e.props.toggleOutfitList})})),a=s.a.createElement("div",{className:"btn addData",onClick:function(){return e.props.getUserData(document.querySelector("#userData").value)}},"Add"),n=s.a.createElement("div",{className:"btn help",onClick:this.toggleInstructions},"?");this.props.sheetId;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{id:"topMenu"},s.a.createElement("span",null,"spreadsheet: "),s.a.createElement("input",{id:"userData",type:"text",defaultValue:this.props.sheetId}),a,n),s.a.createElement("div",{id:"teamViewContainer"},s.a.createElement("div",{id:"teamView"},t)),this.state.isInstructions&&s.a.createElement(E,{toggleInstructions:this.toggleInstructions}))}return null}}]),a}(s.a.Component);function k(e){var t="teamMember"+(e.member.hasOwnProperty("Made")?e.member.Made?"":" notMade":"");return s.a.createElement("div",{className:t,onClick:function(){return e.toggleOutfitList(e.index)}},s.a.createElement("div",{className:"imgContainer"},s.a.createElement(S,{hasMember:e.member}),s.a.createElement(ne,{obj:e.member})),s.a.createElement(se,{attr:e.selAttr,bonus:e.member,maxValue:300,hideIcon:!0}))}function S(e){return s.a.createElement(s.a.Fragment,null,s.a.createElement("img",{className:"platform",src:y.a}),e.hasMember?s.a.createElement("div",{className:"shadow"}):null)}var j=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={isJobList:!1},n.toggleJobList=n.toggleJobList.bind(Object(m.a)(n)),n}return Object(u.a)(a,[{key:"toggleJobList",value:function(){console.log("toggleJobList"),this.setState((function(e,t){return{isJobList:!e.isJobList}}))}},{key:"render",value:function(){if(this.props.activeJob){console.log("JobViewContainer render");var e={attr:this.props.attr,activeJob:this.props.activeJob,teamMembers:this.props.teamMembers,toggleJobList:this.toggleJobList},t={jobs:this.props.jobs,attr:this.props.attr,activeJob:this.props.activeJob,selectJob:this.props.selectJob,toggleJobList:this.toggleJobList};return s.a.createElement("div",{id:"jobView"},s.a.createElement(C,e),s.a.createElement("div",{className:"overlay",style:{top:this.state.isJobList?"0":"100vh"}},s.a.createElement(J,t)))}return null}}]),a}(s.a.PureComponent),C=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;console.log("JobView render");var t=s.a.createElement("div",{className:"btn selectJob",onClick:this.props.toggleJobList},"Change Job"),a=this.props.attr.filter((function(t){return e.props.activeJob[t]>0})),n={},r={};return a.forEach((function(t){n[t]=e.props.activeJob[t],r[t]=e.props.teamMembers.reduce((function(e,a){return a?e+a[t]:e}),0)})),s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"header"},s.a.createElement("div",{className:"title"},s.a.createElement("p",null,this.props.activeJob["Job JP"]),t),s.a.createElement("hr",null),s.a.createElement("div",{className:"statInfo"},s.a.createElement(ne,{obj:this.props.activeJob,alt:this.props.activeJob.Job}),s.a.createElement(se,{maxValue:1500,attr:a,value:r,baseline:n}))),s.a.createElement("div",{className:"workResult"},s.a.createElement(A,{baseline:n,value:r})))}}]),a}(s.a.PureComponent);function A(e){var t=Object.keys(e.baseline).reduce((function(t,a){var n=e.value[a]/e.baseline[a]*(1/3);return t+Math.min(n,1/3)}),0);return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{id:"progressBarContainer"},s.a.createElement("span",{id:"progressBarHide",style:{width:"".concat(100*(1-t),"%")}}),s.a.createElement("span",{id:"progressBar",style:{width:"100%"}})),s.a.createElement("div",{className:"status"},"Work Result: ".concat(Math.floor(100*t),"%")))}var J=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={menus:{Beginner:"\u3010\u521d\u7d1a\u3011",Intermediate:"\u3010\u4e2d\u7d1a\u3011",Advanced:"\u3010\u4e0a\u7d1a\u3011",Unit:"Unit","ES Building":"ES\u30d3\u30eb",Limited:"\u671f\u9593\u9650\u5b9a"},activeMenu:null,viewJob:null},n.toggleProperty=n.toggleProperty.bind(Object(m.a)(n)),n.toggleMenu=n.toggleMenu.bind(Object(m.a)(n)),n.getAvailableMenus=n.getAvailableMenus.bind(Object(m.a)(n)),n.getMenuJobs=n.getMenuJobs.bind(Object(m.a)(n)),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){console.log("JobList componentDidMount"),this.setState({activeMenu:this.props.activeJob.Type,viewJob:this.props.activeJob})}},{key:"toggleProperty",value:function(e,t){this.setState(Object(p.a)({},e,t))}},{key:"toggleMenu",value:function(e){var t=this.getMenuJobs(e)[0];this.setState({activeMenu:e,viewJob:t})}},{key:"getAvailableMenus",value:function(){var e=this,t=Object.keys(this.state.menus),a={},n=new Set(this.props.jobs.map((function(e){return e.Type?e.Type.trim():""})));return t.forEach((function(t){t.length>0&&n.has(t)&&(a[t]=e.state.menus[t])})),a}},{key:"getMenuJobs",value:function(e){return this.props.jobs.filter((function(t){return!!t.Type&&t.Type.trim()===e}))}},{key:"render",value:function(){var e=this,t=s.a.createElement("div",{className:"btn selectJob",onClick:function(){e.props.selectJob(e.state.viewJob),e.props.toggleJobList()}},"Select Job");return this.state.viewJob&&s.a.createElement("div",{className:"overlayContent",id:"jobList"},s.a.createElement("div",{className:"bottom left"},s.a.createElement(N,{menus:this.getAvailableMenus(),activeMenu:this.state.activeMenu,toggleMenu:this.toggleMenu}),s.a.createElement(T,{jobs:this.getMenuJobs(this.state.activeMenu),viewJob:this.state.viewJob,toggleProperty:this.toggleProperty})),s.a.createElement("div",{className:"top right"},s.a.createElement(w,{job:this.state.viewJob,attr:this.props.attr,button:t,toggleJobList:this.props.toggleJobList})))}}]),a}(s.a.Component);function N(e){var t=Object.keys(e.menus).map((function(t){return s.a.createElement("div",{key:t,className:"jobTab"+(e.activeMenu===t?" selected":""),onClick:function(){return e.toggleMenu(t)}},e.menus[t])}));return s.a.createElement("div",{id:"jobTabMenu"},t)}function T(e){var t=e.jobs.map((function(t){var a=e.viewJob.Job===t.Job,n=t["Job JP"]+(a?" selected":"");return s.a.createElement("div",{key:n,className:"jobOpt"+(a?" selected":""),onClick:function(){return e.toggleProperty("viewJob",t)}},t["Job JP"])}));return s.a.createElement("div",{id:"jobSelect"},t)}function w(e){var t=e.attr.filter((function(t){return e.job[t]>0})),a={};t.forEach((function(t){return a[t]=e.job[t]}));var n=s.a.createElement("div",{className:"btn closeJob",onClick:e.toggleJobList},"Cancel");return s.a.createElement("div",{id:"jobDetail"},s.a.createElement("p",null,e.job["Job JP"]),s.a.createElement(ne,{obj:e.job,alt:e.job.Job}),s.a.createElement(se,{maxValue:1500,attr:t,value:a}),s.a.createElement("div",{className:"jobDetailBtns"},e.button,n))}var I=a(15),L=a.n(I),F=a(16),D=a.n(F),B=a(8),U=a.n(B),x=a(17),R=a.n(x),P=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={filters:null,isFilterMenu:!1},n.toggleFilterMenu=n.toggleFilterMenu.bind(Object(m.a)(n)),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this.getSetsFromOutfitArray(this.props.data);this.setState({filters:e})}},{key:"getSetsFromOutfitArray",value:function(e){for(var t=this.props.filters,a=new Array(t.length),n=0;n<a.length;n++)a[n]=new Set;for(var s=0;s<t.length;s++)a[s].add(t[s]);for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<t.length;o++)a[o].add(i[t[o]]);return a}},{key:"toggleFilterMenu",value:function(){this.setState((function(e){return{isFilterMenu:!e.isFilterMenu}}))}},{key:"render",value:function(){if(this.state.filters){var e=s.a.createElement(H,{className:"hideOnPortraitSmall",selAttr:this.props.selAttr,sortOutfits:this.props.sortOutfits,toggleMade:this.props.toggleMade}),t=s.a.createElement(H,{className:"hideOnLandscape",selAttr:this.props.selAttr,sortOutfits:this.props.sortOutfits,toggleMade:this.props.toggleMade});return s.a.createElement("div",{id:"sidebar",className:"toggledOn"},s.a.createElement("div",{className:"btn close",onClick:this.props.toggleOutfitList},s.a.createElement("img",{src:L.a,alt:"\u2190"})),s.a.createElement("span",{id:"status"},this.props.status),s.a.createElement("div",{className:"right"},e,s.a.createElement("div",{className:"btn toggleFilter",onClick:this.toggleFilterMenu},s.a.createElement("img",{src:R.a,alt:"filter options"}))),s.a.createElement(q,{isFilterMenu:this.state.isFilterMenu,filters:this.state.filters,sortMenu:t,submitFilterSelection:this.props.submitFilterSelection,toggleFilterMenu:this.toggleFilterMenu}))}return null}}]),a}(s.a.Component),H=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={activeSort:"Total Bonus",isAscending:!1},n.toggleSort=n.toggleSort.bind(Object(m.a)(n)),n}return Object(u.a)(a,[{key:"toggleSort",value:function(e){var t=this;this.setState((function(t){return t.activeSort===e?{isAscending:!t.isAscending}:{activeSort:e,isAscending:!1}}),(function(){t.props.sortOutfits(e,t.state.isAscending)}))}},{key:"render",value:function(){var e=this,t=this.props.selAttr.map((function(t){return s.a.createElement(V,{key:t,opt:t,isActive:t===e.state.activeSort,isAscending:e.state.isAscending,onClick:function(){return e.toggleSort(t)}})}));return t.unshift(s.a.createElement(V,{key:"Total Bonus",opt:"Total",isActive:"Total Bonus"===this.state.activeSort,isAscending:this.state.isAscending,onClick:function(){return e.toggleSort("Total Bonus")}})),s.a.createElement("div",{id:"sortMenu",className:this.props.className?this.props.className:null},this.props.toggleMade&&s.a.createElement(_,{toggleMade:this.props.toggleMade}),t)}}]),a}(s.a.Component);function V(e){return s.a.createElement("div",{className:"btn sortOpt"+(e.isActive?" active":""),onClick:e.onClick},s.a.createElement("span",{className:"arrow",style:{width:"0.7rem",height:"1rem"}},e.isActive&&(e.isAscending?s.a.createElement("img",{src:D.a,alt:"\u2191"}):s.a.createElement("img",{src:U.a,alt:"\u2193"}))),"Total"!==e.opt?s.a.createElement(ie,{attr:e.opt}):s.a.createElement("span",null,e.opt))}function _(e){return s.a.createElement("div",{className:"radioBtn",id:"toggleMade"},s.a.createElement("input",{type:"checkbox",onClick:e.toggleMade}),s.a.createElement("label",{htmlFor:"toggleMade"},"Show made outfits"))}var q=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={activeMenu:""},n.toggleMenu=n.toggleMenu.bind(Object(m.a)(n)),n}return Object(u.a)(a,[{key:"toggleMenu",value:function(e){console.log("toggleMenu click"),this.setState((function(t){return{activeMenu:t.activeMenu===e?"":e}}))}},{key:"render",value:function(){var e=this,t=this.props.filters.map((function(t){var a=Array.from(t)[0],n="sel"+a;return s.a.createElement(z,{key:a,heading:a,isMenuActive:e.state.activeMenu===a,toggleMenu:function(){return e.toggleMenu(a)},optionsArr:Array.from(t),submitSelection:e.props.submitFilterSelection(n)})}));return s.a.createElement("div",{id:"filterMenu",className:"overlayContent",style:{display:this.props.isFilterMenu?"flex":"none"}},s.a.createElement("div",{className:"topContainer"},s.a.createElement("h4",{className:"hideOnLandscape"},"Sort by..."),this.props.sortMenu,s.a.createElement("h4",null,"Filter by..."),s.a.createElement("div",{id:"filters"},t)),s.a.createElement("div",{className:"bottomContainer"},s.a.createElement("div",{className:"btn",onClick:this.props.toggleFilterMenu},"Close")))}}]),a}(s.a.PureComponent),z=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={selected:new Set},n.toggleOption=n.toggleOption.bind(Object(m.a)(n)),n.clearSelect=n.clearSelect.bind(Object(m.a)(n)),n.selectAll=n.selectAll.bind(Object(m.a)(n)),n.clearFilter=n.clearFilter.bind(Object(m.a)(n)),n}return Object(u.a)(a,[{key:"toggleOption",value:function(e){var t=this.state.selected;this.state.selected.has(e)?t.delete(e):t.add(e),this.setState({selected:t})}},{key:"clearSelect",value:function(){this.setState({selected:new Set})}},{key:"selectAll",value:function(){var e=this.props.optionsArr.slice(),t=e.indexOf(this.props.heading);e.splice(t,1),this.setState({selected:new Set(e)})}},{key:"clearFilter",value:function(){this.clearSelect(),this.props.submitSelection(new Set)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"filter"},s.a.createElement("div",{className:"filterHeading",onClick:this.props.toggleMenu},s.a.createElement("img",{className:"filterIcon",src:U.a}),s.a.createElement("p",null,this.props.heading),this.state.selected.size>0&&s.a.createElement("a",{onClick:this.clearFilter},"clear filter")),this.props.isMenuActive&&s.a.createElement(G,{heading:this.props.heading,optionsArr:this.props.optionsArr,selected:this.state.selected,submitSelection:function(){return e.props.submitSelection(e.state.selected)},toggleMenu:this.props.toggleMenu,toggleOption:this.toggleOption,clearSelect:this.clearSelect,selectAll:this.selectAll}))}}]),a}(s.a.Component),G=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"filterOptions"},s.a.createElement("div",null,s.a.createElement("button",{className:"clearBtn",onClick:this.props.clearSelect},"Clear"),s.a.createElement("button",{className:"selectAllBtn",onClick:this.props.selectAll},"Select All")),s.a.createElement(Y,{heading:this.props.heading,optionsArr:this.props.optionsArr,selected:this.props.selected,toggleOption:this.props.toggleOption}),s.a.createElement("div",null,s.a.createElement("button",{className:"submitBtn",onClick:function(){e.props.toggleMenu(),e.props.submitSelection()}},"OK")))}}]),a}(s.a.Component);function Y(e){var t=e.optionsArr.slice(0).sort();t.indexOf(e.heading)>-1&&t.splice(t.indexOf(e.heading),1);var a=t.map((function(t){return s.a.createElement("li",{key:t,className:e.selected.has(t)?"selected":"",onClick:function(){return e.toggleOption(t)}},s.a.createElement("div",null,s.a.createElement("span",null),t))}));return s.a.createElement("ul",null,a)}var Q=a(18),W=a.n(Q),X=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={error:!1,isLoading:!1,hasMore:!0,loadedOutfits:[],outfitsToLoad:30},n.onScroll=n.onScroll.bind(Object(m.a)(n)),n.loadOutfits=n.loadOutfits.bind(Object(m.a)(n)),n.onScrollThrottled=W()(n.onScroll,100),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.loadOutfits()}},{key:"onScroll",value:function(e){e.persist(),!this.state.isLoading&&this.state.hasMore&&e.target&&window.innerHeight+e.target.scrollTop>=e.target.scrollHeight-600&&this.loadOutfits()}},{key:"loadOutfits",value:function(){var e=this;this.setState({isLoading:!0},(function(){e.setState((function(e,t){var a=e.loadedOutfits;return{hasMore:(a=a.concat(t.outfits.slice(e.loadedOutfits.length,e.loadedOutfits.length+e.outfitsToLoad))).length<t.outfits.length,isLoading:!1,loadedOutfits:a}}))}))}},{key:"render",value:function(){for(var e=this,t=this.state.loadedOutfits.map((function(t){return s.a.createElement(K,{key:t.Character+t.Outfit+t["Total Bonus"],info:t,inTeam:e.props.teamMembers.includes(t),selAttr:e.props.selAttr,setMember:e.props.setMember})})),a=[],n=0;n<4;n++)a.push(s.a.createElement("div",{key:n,className:"outfit-placeholder"}));return s.a.createElement("div",{id:"outfitView",onScroll:this.onScrollThrottled},s.a.createElement("div",{id:"outfitList",className:this.props.view},t,"card"===this.props.view&&a),!this.state.hasMore&&"card"===this.props.view&&s.a.createElement("p",{className:"status"},"End of results"))}}]),a}(s.a.PureComponent);function K(e){var t="outfitCard"+(e.info.hasOwnProperty("Made")?e.info.Made?"":" notMade":"");return s.a.createElement("div",{className:t,onClick:function(){return e.setMember(e.info)}},e.inTeam&&s.a.createElement("div",{className:"inTeam"},"TEAM"),s.a.createElement("p",null,e.info.Character),s.a.createElement("p",null,e.info.Outfit),s.a.createElement("hr",null),s.a.createElement("div",{className:"rowContainer"},s.a.createElement(ne,{obj:e.info,alt:"".concat(e.info.Character," ").concat(e.info.Outfit)}),s.a.createElement("div",{className:"right"},s.a.createElement(se,{attr:e.selAttr,bonus:e.info,maxValue:300}),"Total Bonus"in e.info&&s.a.createElement("div",{className:"bonus"},"TOTAL: ",s.a.createElement("strong",null,e.info["Total Bonus"])))))}var Z="AIzaSyBYN0YVkl2lB5ps2CL_74JKIs5TOukXdm4",$="1JeHlN1zcBwyBbBkyfsDiiqDZpLotkn770ewa1JCsekU";function ee(e,t){return Object.keys(e).map((function(a){var n=a.replace("sel",""),s=e[a],r=t[n];if(s.has(r))return!0}))}function te(e){for(var t=[],a=e[0],n=1;n<e.length;n++){for(var s=e[n],r={},i=0;i<s.length;i++){var o=a[i],l=s[i];isNaN(l)||(l=Number(l)),r[o]=l}t.push(r)}return t}var ae=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={allOutfits:null,userOutfits:null,outfits:null,userSheetId:null,idolStats:null,attr:["Ac","Pa","Un","Sm","Te","Ch"],selAttr:[],jobs:null,activeJob:null,filters:null,isInclusive:!1,isOutfitList:!1,teamMembers:[],teamSlot:null},e.prepareOutfitData=e.prepareOutfitData.bind(Object(m.a)(e)),e.submitFilterSelection=e.submitFilterSelection.bind(Object(m.a)(e)),e.calculateTotalBonus=e.calculateTotalBonus.bind(Object(m.a)(e)),e.toggleSearchTypeTrue=e.toggleSearchTypeTrue.bind(Object(m.a)(e)),e.toggleSearchTypeFalse=e.toggleSearchTypeFalse.bind(Object(m.a)(e)),e.toggleMade=e.toggleMade.bind(Object(m.a)(e)),e.sortByFilter=e.sortByFilter.bind(Object(m.a)(e)),e.sortOutfits=e.sortOutfits.bind(Object(m.a)(e)),e.toggleOutfitList=e.toggleOutfitList.bind(Object(m.a)(e)),e.selectJob=e.selectJob.bind(Object(m.a)(e)),e.setMember=e.setMember.bind(Object(m.a)(e)),e.getUserData=e.getUserData.bind(Object(m.a)(e)),e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log("Main componentDidMount");fetch("https://sheets.googleapis.com/v4/spreadsheets/".concat($,"/values/").concat("Jobs","?key=").concat(Z)).then((function(e){return e.json()})).then((function(t){var a=te(t.values);e.setState({jobs:a});for(var n=0;"Beginner"!==a[n].Type;)n++;e.selectJob(a[n])})).then((function(){fetch("https://sheets.googleapis.com/v4/spreadsheets/".concat($,"/values/").concat("Stat Bonuses","?key=").concat(Z)).then((function(e){return e.json()})).then((function(t){var a=t.values,n={},s=[];a[0].forEach((function(t){"ImageID"===t||e.state.attr.includes(t)||(s.push(t),n["sel"+t]=new Set)}));var r=te(a);n.allOutfits=r,n.outfits=e.prepareOutfitData(r,e.state),n.filters=s,e.setState(n)}))}))}},{key:"toggleOutfitList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.setState((function(t){return{isOutfitList:!t.isOutfitList,teamSlot:e}}))}},{key:"selectJob",value:function(e){var t=this;if(console.log("SelectJob",e),this.state.activeJob!==e){var a={activeJob:e,teamMembers:new Array(e["Idol Slots"]).fill(0),idolStats:this.state.idolStats},n=this.state.userOutfits?this.state.userOutfits:this.state.allOutfits;a.selAttr=Object.keys(e).filter((function(a){return t.state.attr.includes(a)&&e[a]>0})),this.state.outfits&&(a.outfits=this.prepareOutfitData(n,a)),this.setState(a)}}},{key:"toggleSearchTypeTrue",value:function(){this.setState({isInclusive:!0})}},{key:"toggleSearchTypeFalse",value:function(){this.setState({isInclusive:!1})}},{key:"toggleMade",value:function(){var e=null;e=0===this.state.selMade.size?new Set([!0]):new Set,this.submitFilterSelection("selMade")(e)}},{key:"sortByFilter",value:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e.sort((function(e,n){return a?e[t]-n[t]:n[t]-e[t]}))}},{key:"sortOutfits",value:function(e,t){var a=this;this.setState((function(n,s){var r=Object(l.a)(n.outfits);return a.sortByFilter(r,e,t),{outfits:r}}))}},{key:"setMember",value:function(e){this.setState((function(t,a){for(var n=t.teamMembers.slice(),s=t.teamSlot,r=0;r<n.length;r++)if(e.Character===n[r].Character){s=r;break}return n[s]=e,{teamMembers:n,isOutfitList:!1}}))}},{key:"submitFilterSelection",value:function(e){var t=this;return function(a){console.log("submitFilterSelection",a),t.setState((function(n){var s=Object(o.a)({},n);s[e]=a;var r=s.userOutfits?s.userOutfits:s.allOutfits,i=t.prepareOutfitData(r,s);return s.outfits=i,s}))}}},{key:"getQueryAndConditions",value:function(e){return{query:Object.keys(e).reduce((function(t,a){var n=e[a];return a.includes("sel")&&"selAttr"!==a&&n.size>0&&(t[a]=n),t}),{}),conditions:e.activeJob&&e.activeJob.Conditions?e.activeJob.Conditions.split(",").map((function(e){return e.trim()})):[]}}},{key:"prepareOutfitData",value:function(e,t){var a=this.getQueryAndConditions(t);a.isInclusive=t.isInclusive;var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.query||{},n=t.conditions||[],s=t.isInclusive||!1,r=[];if(e){console.log("filterGsData",t);for(var i=function(t){var i=e[t],o=n.length<=0,l=Object.keys(a).length<=0;if(0===Object.keys(a).length&&0===n.length)l=!0;else if(n.length>0&&n.forEach((function(e){Object.values(i).includes(e)&&(o=!0)})),Object.keys(a).length>0){var c=ee(a,i);l=s?c.reduce((function(e,t){return e||t}),!1):c.reduce((function(e,t){return e&&t}),!0)}o&&l&&r.push(JSON.parse(JSON.stringify(i)))},o=0;o<e.length;o++)i(o);return r}}(e,a);return n=this.addIdolStatus(n,t.idolStats),t.selAttr.length>0&&(n=this.calculateTotalBonus(n,t.selAttr),this.sortByFilter(n,"Total Bonus",!1)),n}},{key:"calculateTotalBonus",value:function(e,t){return e.forEach((function(e){var a=0;t.forEach((function(t){return a+=e[t]})),e["Total Bonus"]=a})),e}},{key:"addIdolStatus",value:function(e,t){return t&&e.forEach((function(e){var a=t[e.Character];a&&!e.AddedStat&&(Object.keys(a).forEach((function(t){e.hasOwnProperty(t)&&(e[t]+=a[t])})),e.AddedStat=!0)})),console.log("addIdolStatus",e),e}},{key:"getUserData",value:function(e){var t=this;if(e.length>0){var a=e.replace("https://docs.google.com/spreadsheets/d/",""),n=a.indexOf("/")>0?a.slice(0,a.indexOf("/")):a;console.log(n),fetch("https://sheets.googleapis.com/v4/spreadsheets/".concat(n,"/values/","Outfits","?key=").concat(Z)).then((function(e){return e.json()})).then((function(e){return t.handleErrors(e)})).then((function(e){if(e){var a=e.values,n=a[0].map((function(e){return e.toUpperCase()}));if(n.includes("CHARACTER")&&n.includes("OUTFIT")&&n.includes("MADE")){a[0]=n;var s=te(a);return(s=s.filter((function(e){return e.CHARACTER&&e.OUTFIT}))).sort((function(e,t){return e.CHARACTER.toUpperCase()===t.CHARACTER.toUpperCase()?e.OUTFIT.toUpperCase()<t.OUTFIT.toUpperCase()?-1:e.OUTFIT.toUpperCase()>t.OUTFIT.toUpperCase()?1:0:e.CHARACTER.toUpperCase()<t.CHARACTER.toUpperCase()?-1:e.CHARACTER.toUpperCase()>t.CHARACTER.toUpperCase()?1:0})),console.log("userlist length",s.length),Object(l.a)(t.state.allOutfits).reduce((function(e,t){for(var a=!1,n=0,r=s.length-1;!a&&!(r<n);){var i=Math.floor(n+(r-n)/2);s[i].CHARACTER.toUpperCase()===t.Character.toUpperCase()?s[i].OUTFIT.toUpperCase()<t.Outfit.toUpperCase()?n=i+1:s[i].OUTFIT.toUpperCase()>t.Outfit.toUpperCase()?r=i-1:a=s[i]:s[i].CHARACTER.toUpperCase()<t.Character.toUpperCase()?n=i+1:s[i].CHARACTER.toUpperCase()>t.Character.toUpperCase()&&(r=i-1)}return a?(Object.keys(a).includes("MADE")&&(t.Made="TRUE"===a.MADE),e.push(t),e):e}),[])}t.handleErrors({error:{status:"HEADER NOT FOUND"}})}})).then((function(e){e&&t.setState((function(a){var s=a.teamMembers.map((function(e){return 0})),r=t.prepareOutfitData(e,a);return{userSheetId:n,userOutfits:e,outfits:r,teamMembers:s,selMade:new Set}}))})).then(fetch("https://sheets.googleapis.com/v4/spreadsheets/".concat(n,"/values/","Idol Status","?key=").concat(Z)).then((function(e){return e.json()})).then((function(e){if(e.values){var a=te(e.values),n={};a.forEach((function(e){var t=e.Character;delete e.Character,n[t]=e}));var s=Object(o.a)({},t.state);s.idolStats=n;var r=t.prepareOutfitData(t.state.outfits,s);s.outfits=r,t.setState(s)}})))}}},{key:"handleErrors",value:function(e){if(!e.error)return e;403===e.error.code&&e.error.status.includes("PERMISSION_DENIED")?console.log("Error: Sorter did not have permission to access your spreadsheet. Don't forget to turn link-sharing on!"):400===e.error.code&&e.error.status.includes("INVALID_ARGUMENT")?console.log("Error: Sorter did not find a sheet called 'Outfits' in your spreadsheet."):"HEADER NOT FOUND"!==e.error.status||console.log("Error: Sorter did not find 'Character', 'Outfit', and 'Made' columns in your spreadsheet.")}},{key:"render",value:function(){if(this.state.outfits&&this.state.jobs){var e=this.state.outfits.slice(0,100);e=JSON.stringify(e);var t={activeJob:this.state.activeJob,teamMembers:this.state.teamMembers,jobs:this.state.jobs,attr:this.state.attr,selAttr:this.state.selAttr,selectJob:this.selectJob},a={sheetId:this.state.userSheetId,selAttr:this.state.selAttr,activeJob:this.state.activeJob,teamMembers:this.state.teamMembers,toggleOutfitList:this.toggleOutfitList,getUserData:this.getUserData},n={key:e,outfits:this.state.outfits,teamMembers:this.state.teamMembers,view:this.state.view,attr:this.state.attr,selAttr:this.state.selAttr,setMember:this.setMember,toggleOutfitList:this.toggleOutfitList},r={selAttr:this.state.selAttr,data:this.state.allOutfits,filters:this.state.filters,status:"showing ".concat(this.state.outfits.length," outfits"),submitFilterSelection:this.submitFilterSelection,toggleTrue:this.toggleSearchTypeTrue,toggleFalse:this.toggleSearchTypeFalse,toggleMade:this.state.hasOwnProperty("selMade")&&this.toggleMade,toggleOutfitList:this.toggleOutfitList,sortOutfits:this.sortOutfits};return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{id:"teamBuilder"},s.a.createElement(M,a),this.state.activeJob&&s.a.createElement(j,t)),s.a.createElement("div",{className:"overlay",style:{top:this.state.isOutfitList?"0":"100vh"}},s.a.createElement("div",{className:"overlayContent"},s.a.createElement(P,r),s.a.createElement(X,n))))}return s.a.createElement("div",null,"Loading...")}}]),a}(s.a.Component);function ne(e){return e.obj.ImageID&&"MISSING"!==e.obj.ImageID?s.a.createElement("img",{src:"https://drive.google.com/uc?export=view&id="+e.obj.ImageID,alt:e.alt}):s.a.createElement("div",{className:"imgPlaceholder"},s.a.createElement("div",null,e.alt))}function se(e){var t=e.hideIcon||!1;return s.a.createElement("div",{className:"attrList"},e.attr.map((function(a){var n=(e.value?e.value[a]:0)+(e.bonus?e.bonus[a]:0),r=n;e.bonus&&(e.bonus.AddedStat||(r="+"+r));var i={attr:a,value:n,maxValue:e.maxValue};return e.baseline&&(i.baseline=e.baseline[a]),s.a.createElement("div",{className:"attr",key:a},!t&&s.a.createElement(ie,{attr:a}),s.a.createElement("span",{className:"numberText"},r),s.a.createElement(re,i),e.baseline&&s.a.createElement("span",{className:"numberText"},"".concat(e.value[a]>e.baseline[a]?"+":"").concat(e.value[a]-e.baseline[a])))})))}function re(e){return s.a.createElement("span",{className:"statusBarContainer"},e.baseline&&s.a.createElement("span",{className:"baseline",style:{marginLeft:"".concat(e.baseline/e.maxValue*100,"%")}}),s.a.createElement("span",{className:"statusBar "+e.attr.toLowerCase(),style:{width:"".concat(e.value/e.maxValue*100,"%")}}))}function ie(e){return s.a.createElement("span",{className:"icon "+e.attr.toLowerCase()},e.attr)}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(ae,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[19,1,2]]]);
//# sourceMappingURL=main.4501dd6b.chunk.js.map