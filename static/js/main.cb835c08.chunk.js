(this["webpackJsonpenstars-outfit-sorter"]=this["webpackJsonpenstars-outfit-sorter"]||[]).push([[0],{10:function(e,t,a){e.exports=a(17)},15:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(7),i=a.n(s),l=(a(15),a(8)),o=a(2),c=a(5),u=a(1),h=a(4),m=a(3),p=(r.a.Component,r.a.Component,r.a.Component,r.a.Component,function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={activeMenu:"",filters:null},n.toggleMenu=n.toggleMenu.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this.getSetsFromOutfitArray(this.props.data);this.setState({filters:e})}},{key:"getSetsFromOutfitArray",value:function(e){for(var t=new Array(e[0].length),a=0;a<t.length;a++)t[a]=new Set;for(var n=0;n<e[0].length;n++)t[n].add(e[0][n]);for(var r=1;r<e.length;r++)for(var s=e[r],i=0;i<s.length;i++)t[i].add(s[i]);return t}},{key:"toggleMenu",value:function(e){this.setState((function(t,a){return{activeMenu:t.activeMenu===e?"":e}}))}},{key:"render",value:function(){var e=this;if(this.state.filters){var t=this.state.filters.reduce((function(t,a){var n=Array.from(a);if("ImageID"!==n[0]&&e.props.attr.indexOf(n[0])<0){var s=n[0],i="sel"+s,l=Array.from(new Set(n)).sort((function(e,t){var a=isNaN(e)?e.toUpperCase():Number(e),n=isNaN(t)?t.toUpperCase():Number(t);return a<n?-1:a>n?1:0}));t.push(r.a.createElement(v,{key:s,heading:s,isMenuActive:e.state.activeMenu===s,toggleMenu:function(){return e.toggleMenu(s)},optionsArr:l,submitSelection:e.props.submitFilterSelection(i)}))}return t}),[]);return r.a.createElement("div",{id:"sidebar",className:"toggledOn"},r.a.createElement("div",{className:"filterHeading filter"},r.a.createElement("p",null,"Stat Bonus")),r.a.createElement(d,{optionsArr:this.props.attr,submitSelection:this.props.submitFilterSelection("selAttr")}),r.a.createElement("div",{className:"filterHeading filter"},r.a.createElement("p",null,"Filter data by...")),r.a.createElement(g,{toggleTrue:this.props.toggleTrue,toggleFalse:this.props.toggleFalse}),t)}return null}}]),a}(r.a.Component)),d=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={selected:new Set},n.toggleOption=n.toggleOption.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"toggleOption",value:function(e){var t=this.state.selected;this.state.selected.has(e)?t.delete(e):t.add(e),this.setState({selected:t},this.props.submitSelection(this.state.selected))}},{key:"render",value:function(){var e=this,t=this.props.optionsArr.map((function(t){return r.a.createElement(f,{key:t,option:t,toggleOption:function(){return e.toggleOption(t)}})}));return r.a.createElement("div",{className:"filter attrOptions"},t)}}]),a}(r.a.Component);function f(e){return r.a.createElement("div",null,r.a.createElement("input",{type:"checkbox",onClick:e.toggleOption}),r.a.createElement("span",{className:"icon "+e.option.toLowerCase()},e.option))}function g(e){return r.a.createElement("div",{className:"filter"},r.a.createElement("div",{className:"radioBtn"},r.a.createElement("input",{type:"radio",name:"searchType",id:"false",onClick:e.toggleFalse,defaultChecked:!0}),r.a.createElement("label",{htmlFor:"false"},"Strict match ",r.a.createElement("br",null),r.a.createElement("span",{className:"desc"},"(find outfits that match all search criteria)"))),r.a.createElement("div",{className:"radioBtn"},r.a.createElement("input",{type:"radio",name:"searchType",id:"true",onClick:e.toggleTrue}),r.a.createElement("label",{htmlFor:"true"},"Inclusive match ",r.a.createElement("br",null),r.a.createElement("span",{className:"desc"},"(find outfits that match 1 or more criteria)"))))}var v=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={selected:new Set},n.toggleOption=n.toggleOption.bind(Object(u.a)(n)),n.clearSelect=n.clearSelect.bind(Object(u.a)(n)),n.selectAll=n.selectAll.bind(Object(u.a)(n)),n.clearFilter=n.clearFilter.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"toggleOption",value:function(e){var t=this.state.selected;this.state.selected.has(e)?t.delete(e):t.add(e),this.setState({selected:t})}},{key:"clearSelect",value:function(){this.setState({selected:new Set})}},{key:"selectAll",value:function(){var e=this.props.optionsArr.slice(),t=e.indexOf(this.props.heading);e.splice(t,1),this.setState({selected:new Set(e)})}},{key:"clearFilter",value:function(){this.clearSelect(),this.props.submitSelection(new Set)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"filter"},r.a.createElement("div",{className:"filterHeading"},r.a.createElement("p",{className:"filterIcon",onClick:this.props.toggleMenu},"\u2bc6"),r.a.createElement("p",{onClick:this.props.toggleMenu},this.props.heading),this.state.selected.size>0&&r.a.createElement("a",{onClick:this.clearFilter},"clear filter")),this.props.isMenuActive&&r.a.createElement(b,{heading:this.props.heading,optionsArr:this.props.optionsArr,selected:this.state.selected,submitSelection:function(){return e.props.submitSelection(e.state.selected)},toggleMenu:this.props.toggleMenu,toggleOption:this.toggleOption,clearSelect:this.clearSelect,selectAll:this.selectAll}))}}]),a}(r.a.Component),b=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"filterMenu"},r.a.createElement("div",null,r.a.createElement("button",{className:"clearBtn",onClick:this.props.clearSelect},"Clear"),r.a.createElement("button",{className:"selectAllBtn",onClick:this.props.selectAll},"Select All")),r.a.createElement(O,{heading:this.props.heading,optionsArr:this.props.optionsArr,selected:this.props.selected,toggleOption:this.props.toggleOption}),r.a.createElement("div",null,r.a.createElement("button",{className:"submitBtn",onClick:function(){e.props.toggleMenu(),e.props.submitSelection()}},"OK")))}}]),a}(r.a.Component);function O(e){var t=e.optionsArr.slice(0);t.indexOf(e.heading)>-1&&t.splice(t.indexOf(e.heading),1,"");var a=t.map((function(t){if(t)return r.a.createElement("li",{key:t,className:e.selected.has(t)?"selected":"",onClick:function(){return e.toggleOption(t)}},r.a.createElement("div",null,r.a.createElement("span",null),t))}));return r.a.createElement("ul",null,a)}var E=a(9),y=a.n(E),S=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={error:!1,isLoading:!1,hasMore:!0,loadedOutfits:[],outfitsToLoad:40},n.onScroll=n.onScroll.bind(Object(u.a)(n)),n.loadOutfits=n.loadOutfits.bind(Object(u.a)(n)),n.onScrollThrottled=y()(n.onScroll,100),n.toggleSidebar=function(){document.querySelector("#sidebar").classList.toggle("toggledOn")},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){console.log("OutfitList componentDidMount"),this.loadOutfits()}},{key:"onScroll",value:function(e){e.persist(),!this.state.isLoading&&this.state.hasMore&&e.target&&window.innerHeight+e.target.scrollTop>=e.target.scrollHeight-600&&this.loadOutfits()}},{key:"loadOutfits",value:function(){var e=this;this.setState({isLoading:!0},(function(){e.setState((function(e,t){var a=e.loadedOutfits;return{hasMore:(a=a.concat(t.outfits.slice(e.loadedOutfits.length,e.loadedOutfits.length+e.outfitsToLoad))).length<t.outfits.length,isLoading:!1,loadedOutfits:a}}))}))}},{key:"render",value:function(){for(var e=this,t=this.state.loadedOutfits.map((function(t){return"sheet"===e.props.view?r.a.createElement(j,{key:t.Character+t.Outfit+t["Total Bonus"],info:t}):r.a.createElement(k,{key:t.Character+t.Outfit+t["Total Bonus"],info:t,attr:e.props.attr,selAttr:e.props.selAttr})})),a=[],n=0;n<4;n++)a.push(r.a.createElement("div",{key:n,className:"outfit-placeholder"}));return console.log("OutfitList render"),r.a.createElement("div",{id:"outfitView",onScroll:this.onScrollThrottled},r.a.createElement("div",{id:"toggleSidebarBtn",onClick:this.toggleSidebar}),"card"===this.props.view&&r.a.createElement("p",{className:"status"},this.props.status),r.a.createElement("div",{key:this.props.queryStr,id:"outfitList",className:this.props.view},t,"card"===this.props.view&&a),!this.state.hasMore&&"card"===this.props.view&&r.a.createElement("p",{className:"status"},"End of results"))}}]),a}(r.a.Component);function k(e){return r.a.createElement("div",{className:"outfitCard"},r.a.createElement("p",null,e.info.Character),r.a.createElement("p",null,e.info.Outfit),r.a.createElement("hr",null),r.a.createElement("div",{className:"rowContainer"},r.a.createElement(A,{imageId:e.info.ImageID}),r.a.createElement(N,{attr:e.attr,info:e.info})),"Total Bonus"in e.info&&r.a.createElement("span",null,"TOTAL BONUS: ".concat(e.info["Total Bonus"])))}function j(e){return r.a.createElement(r.a.Fragment,null,Object.keys(e.info).map((function(t){if("ImageID"!==t)return r.a.createElement("div",{key:t,className:"outfitCell"},r.a.createElement("p",null,e.info[t]))})))}function N(e){return r.a.createElement("div",{className:"attrList"},e.attr.map((function(t){return r.a.createElement("div",{className:"attr",key:t+e.info[t]},r.a.createElement("span",{className:"icon "+t.toLowerCase()},t),r.a.createElement("span",{className:"numberText"},"+"+e.info[t]),r.a.createElement("span",{className:"statusBarContainer",style:{width:"".concat(4.2,"rem")}},r.a.createElement("span",{className:"statusBar "+t.toLowerCase(),style:{width:"".concat(e.info[t]/300*4.2,"rem")}})))})))}function A(e){var t=null;return e.imageId&&"missing"!==e.imageId.toLowerCase()?(t="https://drive.google.com/thumbnail?&id="+e.imageId,r.a.createElement("img",{className:"outfitImg",src:t})):r.a.createElement("div",{className:"outfitImg"},"Image N/A")}var C="AIzaSyBYN0YVkl2lB5ps2CL_74JKIs5TOukXdm4",T="1JeHlN1zcBwyBbBkyfsDiiqDZpLotkn770ewa1JCsekU";function w(e,t,a){return Object.keys(e).map((function(n){var r=n.replace("sel",""),s=e[n],i=t[a.indexOf(r)];if(s.has(i))return!0}))}function B(e){for(var t=[],a=e[0],n=1;n<e.length;n++){for(var r=e[n],s={},i=0;i<r.length;i++){var l=a[i],o=r[i];isNaN(o)||(o=Number(o)),s[l]=o}t.push(s)}return t}var M=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).state={data:null,jobData:null,attr:["Ac","Pa","Un","Sm","Te","Ch"],selAttr:new Set,isInclusive:!1,view:"card"},e.prepareOutfitData=e.prepareOutfitData.bind(Object(u.a)(e)),e.submitFilterSelection=e.submitFilterSelection.bind(Object(u.a)(e)),e.calculateTotalBonus=e.calculateTotalBonus.bind(Object(u.a)(e)),e.toggleSearchTypeTrue=e.toggleSearchTypeTrue.bind(Object(u.a)(e)),e.toggleSearchTypeFalse=e.toggleSearchTypeFalse.bind(Object(u.a)(e)),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log("Main componentDidMount");fetch("https://sheets.googleapis.com/v4/spreadsheets/".concat(T,"/values/").concat("Stat Bonuses","?key=").concat(C)).then((function(e){return e.json()})).then((function(t){var a=t.values,n={};a[0].forEach((function(e){"ImageID"!==e[0]&&(n["sel"+e[0]]=new Set)})),n.data=a,e.setState(n)}));fetch("https://sheets.googleapis.com/v4/spreadsheets/".concat(T,"/values/").concat("Jobs","?key=").concat(C)).then((function(e){return e.json()})).then((function(t){var a=t.values;e.setState({jobData:a})}))}},{key:"toggleSearchTypeTrue",value:function(){this.setState({isInclusive:!0})}},{key:"toggleSearchTypeFalse",value:function(){this.setState({isInclusive:!1})}},{key:"submitFilterSelection",value:function(e){var t=this;return function(a){console.log("submitFilterSelection",a),t.setState(Object(l.a)({},e,a))}}},{key:"prepareOutfitData",value:function(e,t){var a=B(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.query||{},n=t.isInclusive||!1,r=[];if(e){var s=e[0];r.push(s),console.log("filterGsData",a);for(var i=1;i<e.length;i++){var l=e[i];if(l[0]){var o=!1;if(0===Object.keys(a).length)o=!0;else{var c=w(a,l,s);o=n?c.reduce((function(e,t){return e||t}),!1):c.reduce((function(e,t){return e&&t}),!0)}o&&r.push(l)}}return r}}(e,t));return this.state.selAttr.size>0&&(a=this.calculateTotalBonus(a,this.state.selAttr),this.sortByFilter(a,"Total Bonus",!1)),a}},{key:"calculateTotalBonus",value:function(e,t){return console.log("Main calculateTotalBonus",t),e.forEach((function(e){var a=0;Array.from(t).forEach((function(t){return a+=e[t]})),e["Total Bonus"]=a})),e}},{key:"sortByFilter",value:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"Total Bonus"===t&&e.sort((function(e,n){return a?e[t]-n[t]:n[t]-e[t]}))}},{key:"render",value:function(){var e=this;if(console.log("Main render"),this.state.data&&this.state.jobData){var t=Object.keys(this.state).reduce((function(t,a){var n=e.state[a];return a.includes("sel")&&"selAttr"!==a&&n.size>0&&(t[a]=n),t}),{}),a=Object.keys(this.state).reduce((function(t,a){var n=e.state[a];return a.includes("sel")&&n.size>0&&(t+=a+":"+Array.from(n)+" "),t}),"");a+="isInclusive: ".concat(this.state.isInclusive);var n=this.prepareOutfitData(this.state.data,{query:t,isInclusive:this.state.isInclusive}),s=(B(this.state.jobData),{key:a,queryStr:a,query:t,outfits:n,view:this.state.view,status:"".concat(n.length," outfits found"),attr:this.state.attr,selAttr:this.state.selAttr}),i={attr:this.state.attr,data:this.state.data,submitFilterSelection:this.submitFilterSelection,toggleTrue:this.toggleSearchTypeTrue,toggleFalse:this.toggleSearchTypeFalse};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"bottomContainer"},r.a.createElement(p,i),r.a.createElement(S,s)))}return null}}]),a}(r.a.Component);var F=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(M,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[10,1,2]]]);
//# sourceMappingURL=main.cb835c08.chunk.js.map