(this["webpackJsonpenstars-outfit-sorter"]=this["webpackJsonpenstars-outfit-sorter"]||[]).push([[0],{11:function(e,t,a){e.exports=a(18)},16:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(8),l=a.n(i),s=(a(16),a(9)),o=a(6),c=a(2),u=a(3),h=a(1),d=a(5),f=a(4),m=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={activeMenu:"",filters:null},n.toggleMenu=n.toggleMenu.bind(Object(h.a)(n)),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this.getSetsFromOutfitArray(this.props.data);this.setState({filters:e})}},{key:"getSetsFromOutfitArray",value:function(e){for(var t=new Array(e[0].length),a=0;a<t.length;a++)t[a]=new Set;for(var n=0;n<e[0].length;n++)t[n].add(e[0][n]);for(var r=1;r<e.length;r++)for(var i=e[r],l=0;l<i.length;l++)t[l].add(i[l]);return t}},{key:"toggleMenu",value:function(e){this.setState((function(t,a){return{activeMenu:t.activeMenu===e?"":e}}))}},{key:"render",value:function(){var e=this;if(this.state.filters){var t=this.state.filters.reduce((function(t,a){var n=Array.from(a);if("ImageID"!==n[0]){var i=n[0],l="sel"+i,s=Array.from(new Set(n)).sort((function(e,t){var a=isNaN(e)?e.toUpperCase():Number(e),n=isNaN(t)?t.toUpperCase():Number(t);return a<n?-1:a>n?1:0}));t.push(r.a.createElement(p,{key:i,heading:i,isMenuActive:e.state.activeMenu===i,toggleMenu:function(){return e.toggleMenu(i)},optionsArr:s,submitSelection:e.props.submitFilterSelection(l)}))}return t}),[]);return t.push(r.a.createElement(p,{key:"Total Bonus",heading:"Total Bonus",isMenuActive:"Total Bonus"===this.state.activeMenu,toggleMenu:function(){return e.toggleMenu("Total Bonus")},optionsArr:this.props.attr,submitSelection:this.props.submitFilterSelection("selAttr")})),r.a.createElement("div",{id:"sidebar",className:"toggledOn"},r.a.createElement("div",{className:"filterHeading filter"},r.a.createElement("p",null,"Filter data by...")),r.a.createElement(b,{toggleTrue:this.props.toggleTrue,toggleFalse:this.props.toggleFalse}),t)}return null}}]),a}(r.a.Component),p=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={selected:new Set},n.toggleOption=n.toggleOption.bind(Object(h.a)(n)),n.clearSelect=n.clearSelect.bind(Object(h.a)(n)),n.selectAll=n.selectAll.bind(Object(h.a)(n)),n.clearFilter=n.clearFilter.bind(Object(h.a)(n)),n}return Object(u.a)(a,[{key:"toggleOption",value:function(e){var t=this.state.selected;this.state.selected.has(e)?t.delete(e):t.add(e),this.setState({selected:t})}},{key:"clearSelect",value:function(){this.setState({selected:new Set})}},{key:"selectAll",value:function(){var e=this.props.optionsArr.slice(),t=e.indexOf(this.props.heading);e.splice(t,1),this.setState({selected:new Set(e)})}},{key:"clearFilter",value:function(){this.clearSelect(),this.props.submitSelection(new Set)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"filter"},r.a.createElement("div",{className:"filterHeading",onClick:this.props.toggleMenu},r.a.createElement("p",{className:"filterIcon"},"\u2bc6"),r.a.createElement("p",null,this.props.heading),this.state.selected.size>0&&r.a.createElement("a",{onClick:this.clearFilter},"clear filter")),this.props.isMenuActive&&r.a.createElement(g,{heading:this.props.heading,optionsArr:this.props.optionsArr,selected:this.state.selected,submitSelection:function(){return e.props.submitSelection(e.state.selected)},toggleMenu:this.props.toggleMenu,toggleOption:this.toggleOption,clearSelect:this.clearSelect,selectAll:this.selectAll}))}}]),a}(r.a.Component),g=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"filterMenu"},r.a.createElement("div",null,r.a.createElement("button",{className:"clearBtn",onClick:this.props.clearSelect},"Clear"),r.a.createElement("button",{className:"selectAllBtn",onClick:this.props.selectAll},"Select All")),r.a.createElement(v,{heading:this.props.heading,optionsArr:this.props.optionsArr,selected:this.props.selected,toggleOption:this.props.toggleOption}),r.a.createElement("div",null,r.a.createElement("button",{className:"submitBtn",onClick:function(){e.props.toggleMenu(),e.props.submitSelection()}},"OK")))}}]),a}(r.a.Component);function v(e){var t=e.optionsArr.slice(0);t.indexOf(e.heading)>-1&&t.splice(t.indexOf(e.heading),1,"");var a=t.map((function(t){if(t)return r.a.createElement("li",{key:t,className:e.selected.has(t)?"selected":"",onClick:function(){return e.toggleOption(t)}},r.a.createElement("div",null,r.a.createElement("span",null),t))}));return r.a.createElement("ul",null,a)}function b(e){return r.a.createElement("div",{className:"filter"},r.a.createElement("div",{className:"radioBtn"},r.a.createElement("input",{type:"radio",name:"searchType",id:"false",onClick:e.toggleFalse,defaultChecked:!0}),r.a.createElement("label",{htmlFor:"false"},"Strict match ",r.a.createElement("br",null),r.a.createElement("span",{className:"desc"},"(find outfits that match all search criteria)"))),r.a.createElement("div",{className:"radioBtn"},r.a.createElement("input",{type:"radio",name:"searchType",id:"true",onClick:e.toggleTrue}),r.a.createElement("label",{htmlFor:"true"},"Inclusive match ",r.a.createElement("br",null),r.a.createElement("span",{className:"desc"},"(find outfits that match 1 or more criteria)"))))}var O=a(10),E=a.n(O),y=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={error:!1,isLoading:!1,hasMore:!0,loadedOutfits:[],outfitsToLoad:40},n.onScroll=n.onScroll.bind(Object(h.a)(n)),n.loadOutfits=n.loadOutfits.bind(Object(h.a)(n)),n.onScrollThrottled=E()(n.onScroll,100),n.toggleSidebar=function(){document.querySelector("#sidebar").classList.toggle("toggledOn")},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){console.log("OutfitList componentDidMount"),this.loadOutfits()}},{key:"onScroll",value:function(e){e.persist(),!this.state.isLoading&&this.state.hasMore&&e.target&&window.innerHeight+e.target.scrollTop>=e.target.scrollHeight-600&&this.loadOutfits()}},{key:"loadOutfits",value:function(){var e=this;this.setState({isLoading:!0},(function(){e.setState((function(e,t){var a=e.loadedOutfits;return{hasMore:(a=a.concat(t.outfits.slice(e.loadedOutfits.length,e.loadedOutfits.length+e.outfitsToLoad))).length<t.outfits.length,isLoading:!1,loadedOutfits:a}}))}))}},{key:"render",value:function(){for(var e=this,t=this.state.loadedOutfits.map((function(t){return"sheet"===e.props.view?r.a.createElement(k,{key:t.Character+t.Outfit+t["Total Bonus"],info:t}):r.a.createElement(S,{key:t.Character+t.Outfit+t["Total Bonus"],info:t,attr:e.props.attr,selAttr:e.props.selAttr})})),a=[],n=0;n<4;n++)a.push(r.a.createElement("div",{key:n,className:"outfit-placeholder"}));return console.log("OutfitList render"),r.a.createElement("div",{id:"outfitView",onScroll:this.onScrollThrottled},r.a.createElement("div",{id:"toggleSidebarBtn",onClick:this.toggleSidebar}),"card"===this.props.view&&r.a.createElement("p",{className:"status"},this.props.status),r.a.createElement("div",{id:"outfitList",className:this.props.view},t,"card"===this.props.view&&a),!this.state.hasMore&&"card"===this.props.view&&r.a.createElement("p",{className:"status"},"End of results"))}}]),a}(r.a.Component);function S(e){return r.a.createElement("div",{className:"outfitCard"},r.a.createElement("p",null,e.info.Character),r.a.createElement("p",null,e.info.Outfit),r.a.createElement("hr",null),r.a.createElement("div",{className:"rowContainer"},r.a.createElement(j,{imageId:e.info.ImageID}),r.a.createElement(T,{attr:e.attr,info:e.info})),"Total Bonus"in e.info&&r.a.createElement("span",null,"TOTAL BONUS: ".concat(e.info["Total Bonus"])))}function k(e){return r.a.createElement(r.a.Fragment,null,Object.keys(e.info).map((function(t){if("ImageID"!==t)return r.a.createElement("div",{key:t,className:"outfitCell"},r.a.createElement("p",null,e.info[t]))})))}function T(e){return r.a.createElement("div",{className:"attrList"},e.attr.map((function(t){return r.a.createElement("p",{className:"attr",key:t+e.info[t]},"".concat(t,": ").concat(e.info[t]))})))}function j(e){var t=null;return e.imageId&&"missing"!==e.imageId.toLowerCase()&&(t="https://drive.google.com/thumbnail?&id="+e.imageId),r.a.createElement("img",{className:"outfitImg",src:t})}function A(e,t,a){return Object.keys(e).map((function(n){var r=n.replace("sel",""),i=e[n],l=t[a.indexOf(r)];if(i.has(l))return!0}))}var N=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={isLoaded:!1,data:null,attr:["Ac","Pa","Un","Sm","Te","Ch"],selAttr:new Set,isInclusive:!1,view:"card"},e.submitFilterSelection=e.submitFilterSelection.bind(Object(h.a)(e)),e.calculateTotalBonus=e.calculateTotalBonus.bind(Object(h.a)(e)),e.toggleSearchTypeTrue=e.toggleSearchTypeTrue.bind(Object(h.a)(e)),e.toggleSearchTypeFalse=e.toggleSearchTypeFalse.bind(Object(h.a)(e)),e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log("Main componentDidMount");fetch("https://sheets.googleapis.com/v4/spreadsheets/".concat("1JeHlN1zcBwyBbBkyfsDiiqDZpLotkn770ewa1JCsekU","/values/").concat("Stat Bonuses","?key=").concat("AIzaSyBYN0YVkl2lB5ps2CL_74JKIs5TOukXdm4")).then((function(e){return e.json()})).then((function(t){var a=t.values,n={isLoaded:!0};a[0].forEach((function(e){"ImageID"!==e[0]&&(n["sel"+e[0]]=new Set)})),n.data=a,e.setState(n)}))}},{key:"toggleSearchTypeTrue",value:function(){this.setState({isInclusive:!0})}},{key:"toggleSearchTypeFalse",value:function(){this.setState({isInclusive:!1})}},{key:"submitFilterSelection",value:function(e){var t=this;return function(a){console.log("submitFilterSelection",a),t.setState(Object(o.a)({},e,a))}}},{key:"calculateTotalBonus",value:function(e,t){return console.log("Main calculateTotalBonus",t),e.forEach((function(e){var a=0;Array.from(t).forEach((function(t){return a+=e[t]})),e["Total Bonus"]=a})),e}},{key:"sortByFilter",value:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"Total Bonus"===t&&e.sort((function(e,n){return a?e[t]-n[t]:n[t]-e[t]}))}},{key:"render",value:function(){var e=this;if(console.log("Main render"),this.state.isLoaded){var t=Object.keys(this.state).reduce((function(t,a){var n=e.state[a];return a.includes("sel")&&"selAttr"!==a&&n.size>0&&(t[a]=n),t}),{}),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.query||{},n=t.isInclusive||!1,r=[];if(e){var i=e[0];r.push(i),console.log("filterGsData",a);for(var l=1;l<e.length;l++){var s=e[l];if(s[0]){var o=!1;if(0===Object.keys(a).length)o=!0;else{var c=A(a,s,i);o=n?c.reduce((function(e,t){return e||t}),!1):c.reduce((function(e,t){return e&&t}),!0)}o&&r.push(s)}}return r}}(this.state.data,{query:t,isInclusive:this.state.isInclusive}),n=function(e){for(var t=[],a=e[0],n=1;n<e.length;n++){for(var r=e[n],i={},l=0;l<r.length;l++){var s=a[l],o=r[l];isNaN(o)||(o=Number(o)),i[s]=o}t.push(i)}return t}(a);this.state.selAttr.size>0&&(n=this.calculateTotalBonus(n,this.state.selAttr),this.sortByFilter(n,"Total Bonus",!1));var i={key:Object.keys(this.state).reduce((function(t,a){var n=e.state[a];return a.includes("sel")&&n.size>0&&(t+=a+":"+Array.from(n)+" "),t}),""),query:t,outfits:n,view:this.state.view,status:"".concat(n.length," outfits found"),attr:this.state.attr,selAttr:this.state.selAttr},l={attr:this.state.attr,data:a,submitFilterSelection:this.submitFilterSelection,toggleTrue:this.toggleSearchTypeTrue,toggleFalse:this.toggleSearchTypeFalse},o=Object(s.a)({},l,{},t);return r.a.createElement(r.a.Fragment,null,r.a.createElement(m,o),r.a.createElement(y,i))}return r.a.createElement("p",null,"Loading")}}]),a}(r.a.Component);var B=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(N,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[11,1,2]]]);
//# sourceMappingURL=main.14e0f715.chunk.js.map